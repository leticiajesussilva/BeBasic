<!-- header -->
<%- include('partials/header.ejs') %>

  <body>

    <!-- header -->
    <%- include('partials/menu.ejs') %>

      <main>
        <section>
          <div class="container">
                <div class="row justify-content-center">
                    <div class="col">
                        <h2 class="text-uppercase text-center">Checkout</h2>
                        <hr/>

                        <div class="mt-3 row justify-content-center">
                          <div class="col col-lg-6 ">
                            <p class="position-relative address-checkout">
                              <a href="/adressregistration" class="address-checkout-link">Editar endereço</a>
                              <strong>Nome da pessoa:</strong><br>
                              606-3727 Ullamcorper. Street<br>
                              Roseville NH 11523<br>
                              (786) 713-8616
                            </p>

                            <hr class="separate" />

                            <div class="card-chosen">
                              <a href="#" class="card-chosen-link">Editar forma de pagamento</a>
                              <div class="card-chosen-flag">
                                <img src="/images/bandeira-mastercard.png" alt="">
                              </div>
                              <div class="card-chosen-number">
                                Master Card terminando em <strong>...20</strong>
                              </div>
                            </div>

                            <hr class="separate" />

                            <div class="products__checkout mt-3">



                              <div class="products__checkout__item">
                                <div class="products__checkout__item__pic">
                                  <a href="#"> <img src=<%= detalheproduto.image_url %> alt=""></a>
                                </div>
                                <div class="products__checkout__item__info">
                                  <div class="products__checkout__item__info__name">
                                    <%= detalheproduto.nome %> -
                                    <%= detalheproduto.cor %>
                                  </div>
                                  <!-- <div id="quantidade" class="products__checkout__item__info__description"></div> -->
                                  <div  id="quantidade" class="products__checkout__item__info__amount">
                                  <div  id="tamanho" class="products__checkout__item__info__amount">

                                    <div class="products__details__amount d-flex my-2 gap-3 align-items-center">
                                      <div class="products__details__amount__amounts">
                                          <div class="number-input">
                                              <!-- <button onclick="this.parentNode.querySelector('input[name=quantity]').stepDown()" class="minus"></button> -->
                                              <!-- <input class="quantity" min="0" name="quantity" value="1" type="number"> -->
                                              <!-- <button onclick="this.parentNode.querySelector('input[type=number]').stepUp()" class="plus"></button> -->
                                          </div>
                                      </div>
                                  </div>

                                  </div>
                                  <div class="products__checkout__item__info__price">
                                    Valor unitário: R$ <%= detalheproduto.preco %>
                                  </div>

                                  <div id="valorfinal">Total a pagar: </div>
                                </div>
                              </div>

                            </div>

                            <hr class="d-none d-lg-block mt-lg-3 separate" />

                            <div class="checkout__bottom text-center">

                              <div class="products__checkout__total my-lg-2">
                                <div class="products__checkout__total__label"><strong>Total: R$ <span id="total"></span></strong></div>
                                <!-- <div class="products__checkout__total__price">R$200,00</div> -->
                              </div>

                              
                            </div>
                            
                          </div>
                        </div>

                    </div>
                </div>
            </div>

          <!-- <div id="itens"> </div> -->
          <!-- <div>Total: <span id="total"></span> </div> -->

          <script>
            var total = 0; // variável que retorna o total dos produtos que estão na LocalStorage.
            var i = 0;     // variável que irá percorrer as posições
            var valor = 0; // variável que irá receber o preço do produto convertido em Float.

            for (i = 1; i <= 99; i++) // verifica até 99 produtos registrados na localStorage
            {
              var prod = localStorage.getItem("produto" + i + "" ); // verifica se há recheio nesta posição.
              if (prod != null) {
                // exibe os dados da lista dentro da div itens
                document.getElementById("quantidade").innerHTML += localStorage.getItem("qtd" + i) + " Unidades <%= detalheproduto.nome %>. ";
                document.getElementById("tamanho").innerHTML += localStorage.getItem("produto" + i);
                document.getElementById("valorfinal").innerHTML += " ";
                document.getElementById("valorfinal").innerHTML += "R$: " + localStorage.getItem("valor" + i) + "<hr>";
                // document.getElementById("itens").innerHTML += "Escrevendo aqui " + localStorage.getItem("nome" + i) + "<hr>";

                // calcula o total dos recheios
                valor = parseFloat(localStorage.getItem("valor" + i)); // valor convertido com o parseFloat()
                total = (total + valor); // arredonda para 2 casas decimais com o .toFixed(2)
              }
            }
            // exibe o total dos recheios
            document.getElementById("total").innerHTML = total.toFixed(2);



            function finalizarCompra() {
              alert("Compra finalizada com sucesso!");
            }

          </script>

          <button type="button" onclick=" finalizarCompra() " class="btn form__submit position-static">Finalizar compra</button>
          <button type="button" onclick=" localStorage.clear(); location.reload();"> Limpar carrinho </button>

        </section>

        <%- include('partials/trending.ejs') %>

          <%- include('partials/benefits.ejs') %>

            <%- include('partials/instagram.ejs') %>

      </main>

      <!-- footer -->
      <%- include('partials/footer.ejs') %>

  </body>

  </html>